# A Survey on Causal Inference

几十年来，因果推理是许多领域的关键研究课题，例如统计学、计算机科学、教育、公共政策和经济学。
如今，与随机对照试验相比，由于可用数据量大、预算要求低，从观察数据估计因果效应已成为一个有吸引力的研究方向。
拥抱快速发展的机器学习领域，各种因果关系估计方法、观测数据如雨后春笋般涌现。  
在本篇综述中，我们对潜在结果框架下的因果推理方法进行了全面回顾，这是众所周知的因果推理框架之一。
根据是否需要潜在结果框架的所有三个假设，这些方法分为两类。对于每个类别， 讨论和比较了传统的统计方法和最近的机器学习增强方法。
还介绍了这些方法的合理应用，包括在广告、推荐、医学等方面的应用。此外，还总结了常用的基准数据集和开源代码，便于研究人员和从业者探索、评估和应用因果推理方法。

## 前言

在日常语言中，相关性和因果关系通常可以互换使用，尽管它们有完全不同的解释。 
相关性表示一般关系：当两个变量显示出增加或减少的趋势时，它们是相关的 [6]。 
因果关系也称为因果，其中原因对结果部分负责，而结果部分取决于原因。 
因果推理是根据结果发生的条件得出有关因果关系的结论的过程。 
因果推断和相关推断的主要区别在于前者分析了当原因改变时受影响变量的反应[91, 130]。

众所周知，“相关并不意味着因果”。 
例如，一项研究表明，吃早餐的女孩通常比不吃早餐的女孩更轻，因此得出结论，吃早餐有助于减肥。 
但实际上，这两个事件可能只是相关性而非因果性。 
或许每天吃早餐的女孩子们的生活方式更好，比如经常运动、规律睡眠、健康饮食，最终让她们拥有了轻盈的体态。 
在这种情况下，拥有更好的生活方式是早餐和体重轻的共同原因，因此我们也可以将其视为早餐和体重轻之间因果关系的`混杂因素`。 

在许多情况下，一个动作可能导致另一个动作似乎很明显。
但是，也存在很多情况是我们不能轻易梳理和确定关系的。
因此，学习因果关系是一个非常具有挑战性的问题。
推断因果关系的最有效方法是进行随机对照试验，将参与者随机分配到治疗组或对照组。
在进行随机研究时，对照组和治疗组之间唯一的预期差异是正在研究的结果变量。
然而，实际上，随机对照试验总是耗时且昂贵，因此该研究不能涉及许多受试者，这可能不代表治疗/干预最终将针对的现实世界人群。另一个问题是，随机对照试验只关注样本的平均值，并没有解释机制或适用于个体受试者。
此外，大多数随机对照试验还需要考虑伦理问题，这在很大程度上限制了其应用。
因此，代替随机对照试验，观察数据是一条诱人的捷径。
观察数据是由研究人员在没有任何干扰的情况下简单地观察受试者获得的。
这意味着，研究人员无法控制治疗和受试者，他们只是观察受试者并根据他们的观察记录数据。
从观察数据中，我们可以找到他们的行动、结果和发生的事情的信息，但无法弄清楚他们采取特定行动的机制。
对于观测数据，核心问题是如何得到反事实结果。
例如，我们要回答这个问题“如果该患者接受不同的药物治疗会有不同的结果吗？
”由于两个原因，回答此类反事实问题具有挑战性[119]：第一个是我们只观察事实结果，而从未观察到如果他们选择了不同的治疗方案可能会发生的反事实结果。
第二个是治疗通常不是在观察数据中随机分配的，这可能导致治疗人群与一般人群有显着差异。

为了解决从观察数据进行因果推断的这些问题，研究人员开发了各种框架，包括潜在结果框架 [111, 129] 和结构因果模型 [89, 92, 94]。潜在结果框架也称为内曼-鲁宾潜在结果或鲁宾因果模型。
在我们上面提到的例子中，如果一个女孩每天正常吃早餐，她的体重会有所不同，而如果她不正常吃早餐，她的体重会有所不同。
为了衡量一个女孩正常吃早餐的因果效应，我们需要比较同一个人在两种情况下的结果。
显然，不可能同时看到两种潜在结果，并且总是缺少其中一种潜在结果。
潜在结果框架旨在估计此类潜在结果，然后计算治疗效果。因此，治疗效果估计是潜在结果框架下因果推理的核心问题之一。
因果推理中另一个有影响的框架是结构因果模型（SCM），它包括因果图和结构方程。
结构因果模型描述了系统的因果机制，其中一组变量及其之间的因果关系由一组联立的结构方程建模。

因果推理与机器学习领域有着密切的关系。近年来，机器学习领域的华丽绽放，促进了因果推理领域的发展。强大的机器学习方法，如决策树、集成方法、深度神经网络，用于更准确地估计潜在结果。
除了对结果估计模型的改进之外，机器学习方法还提供了处理混杂因素的新方面。受益于最近的深度表示学习方法，例如生成对抗神经网络，混杂变量通过学习所有协变量的平衡表示来调整，从而以学习的表示为条件，处理分配独立于混杂变量。
在机器学习中，数据越多越好。 
然而，在因果推理中，仅靠更多的数据是不够的。
拥有更多数据仅有助于获得更精确的估计，但不能确保这些估计是正确和无偏的。
机器学习方法促进了因果推理的发展，同时，因果推理也有助于机器学习方法。
现代机器学习研究对预测准确性的简单追求是不够的，正确性和可解释性也是机器学习方法的目标。
因果推理开始有助于改进机器学习，例如推荐系统或强化学习。

在本文中，我们对潜在结果框架下的因果推理方法进行了全面回顾。 
我们首先介绍潜在结果框架的基本概念及其三个关键假设，以识别因果效应。 
之后，详细讨论了具有这三个假设的各种因果推理方法，包括重新加权方法、分层方法、基于匹配的方法、基于树的方法、基于表示的方法、基于多任务学习的方法和元学习 方法。 
此外，还描述了放宽三个假设的因果效应估计方法，以满足不同环境中的需求。 
在介绍了各种因果效应估计方法之后，讨论了所讨论的方法具有巨大潜力的实际应用，包括以广告领域、推荐领域、医学领域和强化学习领域为代表的例子。

据我们所知，这是第一篇在潜在结果框架下对因果推理方法进行全面综述的论文。还有一些综述讨论了一类因果效应估计方法，例如基于匹配的方法的综述 [131]、基于树和基于集合的方法的综述 [10]，以及对动态治疗方案的审查 [131]。 25]。
对于结构因果模型， 建议参考调查[91]或书籍[90]。我们还将在综述结束时简要讨论两个因果关系框架之间的关系和差异。
还有一种关于从观察数据中学习因果关系的综述[44]，其内容包括从观察数据中推断因果图、结构因果模型、潜在结果框架及其与机器学习的联系。
与上述综述相比，本综述论文主要关注潜在结果框架的理论背景，统计领域和机器学习领域的代表性方法，以及该框架和机器学习领域如何相互增强。

总而言之，我们对本篇综述的贡献如下：

- 新分类法：我们根据是否需要潜在结果框架的三个假设，将各种因果推理方法分为两大类。 
需要三个假设的类别根据处理混杂变量的方式进一步分为七个子类别。

- 全面审查：我们对潜在结果框架下的因果推理方法进行了全面调查。 
在每个类别中，都提供了代表性方法的详细描述，所提到的方法之间的联系和比较，以及一般总结。

本文的其余部分安排如下。 
在第 2 节中，介绍了潜在结果框架的背景，包括基本定义、假设及其一般解决方案的基本问题。 
在第 3 节中，介绍了三种假设下的方法。 
然后，在第 4 节中，我们讨论不满足某些假设时的问题，并描述放松这些假设的方法。 
接下来，我们在第 5 节中提供实验指南。之后，在第 6 节中，说明了因果推理的典型应用。 
最后，第 7 节总结了本文。

## BASIC OF CAUSAL INFERENCE

在本节中，我们介绍了因果推理的背景知识，包括任务描述、数学概念、假设、挑战和一般解决方案。 
我们还提供了一个说明性示例，将在整个调查中使用。

一般来说，因果推理的任务是估计如果应用了另一种治疗方法的结果变化。 
例如，假设有两种治疗方法可以应用于患者：药物 A 和药物 B。将药物 A 应用于感兴趣的患者队列时，恢复率为 70%，而将药物 B 应用于同一队列时，恢复率 是 90%。 
恢复率的变化是治疗（即本例中的药物）对恢复率的影响。

上面的例子描述了一种衡量治疗效果的理想情况：对同一个队列应用不同的治疗。 
在现实世界的场景中，这种理想情况只能通过随机实验来近似，其中治疗分配受到控制，例如完全随机分配。 
通过这种方式，接受特定治疗的群体可以被视为我们感兴趣的群体的近似值。

### 2.1 Definitions

在这里，我们在潜在结果框架 [111, 129] 下定义符号，这在逻辑上等同于另一个框架，即结构因果模型框架 [62]。 
潜在结果框架的基础是因果关系与应用于一个单位的治疗（或行动、操作、干预）相关[59]。 
治疗效果是通过比较单位治疗的潜在结果来获得的。 下面，我们首先介绍因果推理中的三个基本概念：单位、处理和结果。

定义 1. 单位。 单位是处理效果研究中的原子研究对象。

一个单位可以是特定时间点的物理对象、公司、患者、个人或对象或人员的集合，例如教室或市场[59]。 
在潜在成果框架下，不同时间点的原子研究对象是不同的单位。 
数据集中的一个单位是整个人口的样本，因此在本次调查中，术语“样本”和“单位”可以互换使用。